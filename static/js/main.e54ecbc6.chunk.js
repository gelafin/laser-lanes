(this["webpackJsonplaser-lanes"]=this["webpackJsonplaser-lanes"]||[]).push([[0],{19:function(e,t,i){},20:function(e,t,i){"use strict";i.r(t);var a=i(0),s=i(3),n=i.n(s),l=i(11),r=i.n(l),c=i(2),h=i(12),o=i(9),u=(i(7),i(4)),p=i(5),g=i(1),d=i(10),f=i(8);i(19);function S(e,t){return Math.floor(Math.random()*(t-e))+e}function v(e){var t="https://live.staticflickr.com/65535/50724769872_da72a3fd7c_t.jpg",i="https://live.staticflickr.com/65535/50724684336_aaa14d5649_t.jpg";return!e.isAlly&&e.isAlive?Object(a.jsxs)("div",{className:"ship",children:[Object(a.jsx)("img",{src:e.isAlly?i:t}),Object(a.jsx)(y,{isAlly:!1,laserState:e.state})]}):!0===e.isAlive?Object(a.jsxs)("div",{className:"ship",children:[Object(a.jsx)(y,{isAlly:!0,laserState:e.state}),Object(a.jsx)("img",{src:e.isAlly?i:t})]}):Object(a.jsx)("div",{className:"ship"})}function y(e){var t,i=e.laserState,s=e.isAlly;if("charging"===i)t=s?"https://live.staticflickr.com/65535/50723947808_35ba1cd9e7_o.png":"https://live.staticflickr.com/65535/50724684381_4ca6f500da_t.jpg";else{if("firing"!==i)return Object(a.jsx)("div",{className:"laser"});t=s?"https://live.staticflickr.com/65535/50724684431_e854d32aa9_o.png":"https://live.staticflickr.com/65535/50723947768_2ab5054c24_t.jpg"}return Object(a.jsx)("img",{src:t,className:"laser"})}function j(e){var t=Object.values(e.ships).map((function(e){return Object(a.jsx)(v,{isAlly:e.isAlly(),isAlive:e.isAlive(),state:e.getState()},e.getId())}));return Object(a.jsx)("ul",{className:"game-row",children:t})}function b(e){var t=e.output,i=Array.from(t),s=e.reactKeys.values(),n=i.map((function(e,t){return Object(a.jsx)("div",{column:t,children:e},s.next().value)}));e.outputCharKeys;return Object(a.jsx)("div",{className:"output-container",children:Object(a.jsx)("ul",{className:"game-text game-row",children:n})})}var m=function(e){Object(d.a)(i,e);var t=Object(f.a)(i);function i(e){var a;return Object(u.a)(this,i),(a=t.call(this,e)).handleChange=a.handleChange.bind(Object(g.a)(a)),a}return Object(p.a)(i,[{key:"handleChange",value:function(e){this.props.onInputChange(e.target.value)}},{key:"render",value:function(){return Object(a.jsx)("form",{className:"input-container game-text-container flex-container",children:Object(a.jsx)("input",{type:"text",value:this.props.input,className:"input-box game-text",onChange:this.handleChange})})}}]),i}(n.a.Component);var O=function(){function e(t,i){Object(u.a)(this,e),this.alive=!0,this.state="idle",this.lane=i,this.ally=t;var a=t?"ally":"enemy";this.id=a+i.toString()}return Object(p.a)(e,[{key:"getState",value:function(){return this.state}},{key:"getId",value:function(){return this.id}},{key:"getLane",value:function(){return this.lane}},{key:"isAlly",value:function(){return this.ally}},{key:"isAlive",value:function(){return this.alive}},{key:"destroy",value:function(){this.alive=!1}},{key:"print",value:function(){console.log("\tid:",this.getId()),console.log("\tisAlly:",this.isAlly()),console.log("\tlane:",this.getLane()),console.log("\tstate:",this.getState()),console.log("\talive:",this.isAlive())}},{key:"advanceState",value:function(){return"idle"===this.state?this.state="charging":"charging"===this.state?this.state="firing":this.state="idle",this.state}}]),e}();var x=function(e){Object(d.a)(i,e);var t=Object(f.a)(i);function i(e){var a;Object(u.a)(this,i);(a=t.call(this,e)).maxColumns=7,a.allLanes=Array.from(new Array(7).keys()),a.tickMs=1e4,a.laserFireMs=Math.floor(a.tickMs/a.tickMs);var s,n={},l={},r=Object(o.a)(a.allLanes.values());try{for(r.s();!(s=r.n()).done;){var c=s.value,h=new O(!0,c);n[h.getId()]=h;var p=new O(!1,c);l[p.getId()]=p}}catch(S){r.e(S)}finally{r.f()}var d={firingShips:[],chargingShips:[],idleShips:Array.from(Object.keys(n))},f={firingShips:[],chargingShips:[],idleShips:Array.from(Object.keys(l))};return a.state={input:"testt",allyShips:n,enemyShips:l,allyShipStates:d,enemyShipStates:f},a.handleInputChange=a.handleInputChange.bind(Object(g.a)(a)),a.tick=a.tick.bind(Object(g.a)(a)),a.advanceShipState=a.advanceShipState.bind(Object(g.a)(a)),a.fireAllChargingShips=a.fireAllChargingShips.bind(Object(g.a)(a)),a.getLetterInLane=a.getLetterInLane.bind(Object(g.a)(a)),a.projectLaserTarget=a.projectLaserTarget.bind(Object(g.a)(a)),a.laneToId=a.laneToId.bind(Object(g.a)(a)),a.destroyShip=a.destroyShip.bind(Object(g.a)(a)),a.getOppositeShip=a.getOppositeShip.bind(Object(g.a)(a)),a.fireLaser=a.fireLaser.bind(Object(g.a)(a)),a.haltLaser=a.haltLaser.bind(Object(g.a)(a)),a}return Object(p.a)(i,[{key:"advanceShipState",value:function(e){var t,i,a;e.includes("ally")?(t=this.state.allyShips[e],i="allyShipStates",a="allyShips"):(t=this.state.enemyShips[e],i="enemyShipStates",a="enemyShips");var s,n,l=t.getState(),r=Object(h.a)({},this.state[a]);r[e].advanceState(),this.setState(Object(c.a)({},a,r)),"idle"===l?(n="idleShips",s="chargingShips"):"charging"===l?(n="chargingShips",s="firingShips"):(n="firingShips",s="idleShips");var o=this.state[i][n].indexOf(e),u=this.state[i][s],p=this.state[i][n];u.push(e),p.splice(o,1),this.setState(Object(c.a)({},[i][s],u)),this.setState(Object(c.a)({},[i][n],p))}},{key:"getLetterInLane",value:function(e){if("number"===typeof e)return(e>=this.allLanes.length||e<0)&&console.log("Error: out of bounds lane given to getLetterInLane"),this.state.input[e];console.log("Error: expected lane to be type number, but got",typeof e)}},{key:"getOppositeShip",value:function(e,t){var i=this.laneToId(e,!t),a=t?"enemyShips":"allyShips";return this.state[a][i]}},{key:"projectLaserTarget",value:function(e,t){var i=this.getLetterInLane(e);if(i&&-1===["a","e","i","o","u"].indexOf(i.toLowerCase()))return"consonant";var a=this.getOppositeShip(e,t);return"firing"===a.state?"otherBeam":a.isAlive()?"otherShip":"empty"}},{key:"haltLaser",value:function(e){var t,i;t=e.isAlly()?"allyShipStates":"enemyShipStates",i="idle"===e.getState()?"idleShips":"charging"===e.getState()?"chargingShips":"firingShips";var a=this.state[t][i].indexOf(e.getId()),s=this.state[t][i];s.splice(a,1),this.setState(Object(c.a)({},[t][i],s))}},{key:"destroyShip",value:function(e){console.log("\tdestroying ",e.getId(),"..."),this.sfx.explosion.play().catch((function(){console.log("\tERROR: explosion audio play() promise rejected. Click into the text box--or else this is localhost")})),e.destroy(),this.haltLaser(e)}},{key:"laneToId",value:function(e,t){return t?"ally"+e:"enemy"+e}},{key:"fireLaser",value:function(e){var t=this;console.log("***firing",e.getId());var i=e.getId(),a=e.getLane(),s=e.isAlly(),n=this.projectLaserTarget(a,s);if("consonant"===n)console.log("\tlaser blocked by consonant");else if("otherBeam"===n)console.log("\tlaser blocked by other beam");else if("empty"===n)console.log("\tlaser passes through empty lane");else if("otherShip"===n){var l=this.getOppositeShip(a,s);console.log("\tlaser destroys",l.getId()),this.destroyShip(l),this.haltLaser(e)}setTimeout((function(){t.advanceShipState(i)}),this.laserFireMs)}},{key:"fireAllChargingShips",value:function(){var e,t=Object(o.a)(this.allLanes);try{for(t.s();!(e=t.n()).done;){var i=e.value,a=this.laneToId(i,!0),s=this.laneToId(i,!1),n=this.state.allyShips[a],l=this.state.enemyShips[s];"charging"!==n.getState()&&"charging"!==l.getState()||("charging"===n.getState()&&"charging"!==l.getState()?(this.advanceShipState(a),this.fireLaser(n)):"charging"===l.getState()&&"charging"!==n.getState()?(this.advanceShipState(s),this.fireLaser(l)):(console.log("***firing ally and enemy lasers in lane ",i),this.advanceShipState(a),this.advanceShipState(s),this.fireLaser(n),this.fireLaser(l)))}}catch(r){t.e(r)}finally{t.f()}}},{key:"tick",value:function(){var e=this;console.log("----- ticking -----"),this.fireAllChargingShips(),this.setState((function(t){var i=S(0,t.allyShipStates.idleShips.length),a=S(0,t.enemyShipStates.idleShips.length),s=t.allyShipStates.idleShips[i],n=t.enemyShipStates.idleShips[a];e.advanceShipState(s),e.advanceShipState(n)}),(function(){console.log(" > finished tick setState! Best to call advanceShipState here")}))}},{key:"componentDidMount",value:function(){var e=this;this.timerID=setInterval((function(){return e.tick()}),this.tickMs),this.sfx={explosion:new Audio("./sfx/explosion.mp3"),chargingLaser:new Audio("./sfx/charging_laser.mp3"),firingLaser:new Audio("./sfx/firing_laser.mp3")},this.sfx.explosion.volume=.1,this.sfx.chargingLaser.volume=.1}},{key:"componentWillUnmount",value:function(){clearInterval(this.timerID)}},{key:"handleInputChange",value:function(e){this.setState({input:e}),console.log("set input to ",e)}},{key:"render",value:function(){var e=this.maxColumns,t=new Array(e).fill(0).map((function(e,t){return t}));return Object(a.jsxs)("div",{className:"game-container flex-container",children:[Object(a.jsxs)("div",{className:"visuals-container",children:[Object(a.jsx)(j,{ships:this.state.enemyShips}),Object(a.jsx)(b,{output:this.state.input,reactKeys:t}),Object(a.jsx)(j,{ships:this.state.allyShips})]}),Object(a.jsx)("div",{children:Object(a.jsx)(m,{input:this.state.input,onInputChange:this.handleInputChange})})]})}}]),i}(n.a.Component),k=function(e){e&&e instanceof Function&&i.e(3).then(i.bind(null,21)).then((function(t){var i=t.getCLS,a=t.getFID,s=t.getFCP,n=t.getLCP,l=t.getTTFB;i(e),a(e),s(e),n(e),l(e)}))};r.a.render(Object(a.jsx)(x,{}),document.getElementById("root")),k()}},[[20,1,2]]]);
//# sourceMappingURL=main.e54ecbc6.chunk.js.map